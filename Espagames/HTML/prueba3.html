<!DOCTYPE html>
<html>
<head>
    <title>Espagames</title>
</head>
<body>

<div class="cubo">
    <div class="cubo1">
        <div class="peque침in">
            <img src="../imagenes/pequenin47.png" class="img3">
        </div>
<div class="texto" id="texto" 
ondragover="permitirSoltar(event)" 
             ondrop="soltarLetra(event)" 
             ondragleave="quitarEstilo()" 
             ondragenter="agregarEstilo()">

    <button class="empezar" id="btnEmpezar" onclick="iniciarJuego()">Empezar</button>

        </div>
    </div>

    <div class="cubo2">
        <div class="subcubo">
            <div class="cubito" draggable="true" ondragstart="arrastrarLetra(event)" data-letra="PL">PL</div>
            <div class="cubito" draggable="true" ondragstart="arrastrarLetra(event)" data-letra="BL">BL</div>
            <div class="cubito" draggable="true" ondragstart="arrastrarLetra(event)" data-letra="CL">CL</div>
            <div class="cubito" draggable="true" ondragstart="arrastrarLetra(event)" data-letra="FL">FL</div>
            <div class="cubito" draggable="true" ondragstart="arrastrarLetra(event)" data-letra="GL">GL</div>
        </div>

        <div class="subcubo">
            <div class="correcto">C: <span id="correctos">0</span></div>
            <div class="tiempo" id="tiempo">05:00</div>
            <div class="incorrecto">F: <span id="incorrectos">0</span></div>
        </div>
    </div>
</div>

<div id="resultado" class="res" style="display:none;">
    <h2>Juego terminado</h2>
    <p>Puntuaci칩n final: <span id="puntajeFinal"></span></p>
    <p>Nota: <span id="nota"></span></p>
    <div class="botones">
        <button class="boton2" onclick="location.reload()">Reiniciar</button>
        <button class="boton2" onclick="salir()">Escoger otro</button>
    </div>
</div>

<style>
    @import url("../CSS/prueba3.css");
</style>

<script>
    const palabras = [
        { texto: "_OR", respuesta: "FL", palabraCompleta: "flor" },
        { texto: "_ATO", respuesta: "PL", palabraCompleta: "plato" },
        { texto: "_UMA", respuesta: "CL", palabraCompleta: "cluma" },
        { texto: "_USA", respuesta: "BL", palabraCompleta: "blusa" },
        { texto: "_OBO", respuesta: "GL", palabraCompleta: "globo" }
    ];

    let indice = 0;
    let correctos = 0;
    let incorrectos = 0;
    let tiempo = 300;
    let interval;
    let juegoIniciado = false;

    function iniciarTemporizador() {
        interval = setInterval(() => {
            if (tiempo > 0) {
                tiempo--;
                const minutos = Math.floor(tiempo / 60);
                const segundos = tiempo % 60;
                document.getElementById('tiempo').innerText =
                    `${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
            } else {
                clearInterval(interval);
                finalizarJuego();
            }
        }, 1000);
    }

    function hablar(texto) {
        const mensaje = new SpeechSynthesisUtterance(texto);
        mensaje.lang = "es-ES";
        speechSynthesis.cancel(); 
        speechSynthesis.speak(mensaje);
    }

    function mostrarPalabra() {
        const actual = palabras[indice];
        document.getElementById('texto').innerText = actual.texto;
        hablar(actual.palabraCompleta); 
    }

    function verificarRespuesta(opcion) {
        const actual = palabras[indice];
        if (opcion === actual.respuesta) {
            correctos++;
            document.getElementById('correctos').innerText = correctos;
        } else {
            incorrectos++;
            document.getElementById('incorrectos').innerText = incorrectos;
        }

        indice++;
        if (indice >= palabras.length) {
            indice = 0; // 游대 Reinicia para que sea infinito
        }
        mostrarPalabra();
    }

    function finalizarJuego() {
        clearInterval(interval);
        const resultadoFinal = correctos - incorrectos;
        let nota = "F";
        if (resultadoFinal >= 8) nota = "A";
        else if (resultadoFinal >= 6) nota = "B";
        else if (resultadoFinal >= 4) nota = "C";

        document.getElementById('puntajeFinal').innerText = resultadoFinal;
        document.getElementById('nota').innerText = nota;
        document.getElementById('resultado').style.display = 'block';
    }

    function salir() {
        window.location.href = "Espagames.html";
    }

    function iniciarJuego() {
        if (!juegoIniciado) {
            juegoIniciado = true;
            document.getElementById("btnEmpezar").style.display = "none"; // ocultar el bot칩n
            iniciarTemporizador();
            mostrarPalabra();
        }
    }

    // Drag & Drop
    function arrastrarLetra(event) {
        event.dataTransfer.setData("letra", event.target.dataset.letra);
    }

    function permitirSoltar(event) {
        event.preventDefault();
    }

    function soltarLetra(event) {
        event.preventDefault();
        quitarEstilo();
        const letra = event.dataTransfer.getData("letra");
        verificarRespuesta(letra);
    }

    function agregarEstilo() {
        document.getElementById("texto").classList.add("sobre");
    }

    function quitarEstilo() {
        document.getElementById("texto").classList.remove("sobre");
    }
</script>

</body>
</html>
