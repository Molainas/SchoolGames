<!DOCTYPE html>
<html>
<head>
    <title>Inglegames</title>
</head>    
<body>
<div class="cubo"> 
    <div class="cubo1">
        <div class="ejemplo">
            <script>
                const letras = ["Aa", "Bb", "Cc", "Dd", "Ee", "Ff", "Gg", "Hh", "Ii", "Jj", "Kk", "Ll", "Mm", "Nn", "Oo", "Pp", "Qq", "Rr", "Ss", "Tt", "Uu", "Vv", "Ww", "Xx", "Yy", "Zz"];
                let posX = 30;
                let posY = 60;
                
                letras.forEach((letra, index) => {
                    document.write(`<button class="letra" style="top: ${posY}px; left: ${posX}px;" draggable="true">${letra}</button>`);
                    posY += 70;
                    if ((index + 1) % 5 === 0) { 
                        posY = 60;
                        posX += 60;
                    }
                });
            </script>
        </div>
        <div class="mesa">
            <div class="lugar" id="lugar">
                <button class="empezar" id="btnEmpezar" onclick="iniciarJuego()">EMPEZAR</button>
            </div>
            <div class="pequeñin"><img src="../imagenes/escritorio2.png" class="peque"></div>
        </div>
    </div>

    <div class="cubo2">
        <button class="verificacion" onclick="verificarRespuesta()">VERIFICAR</button>
        <div class="puntos">
            <div class="correcto">C: <span id="correctos">0</span></div>
            <div class="incorrecto">F: <span id="incorrectos">0</span></div>
        </div>
        <div class="tiempo" id="tiempo">4:00</div>
    </div>
</div>

<div id="resultado" class="res" style="display:none;">
    <h2>Juego terminado</h2>
    <p>Puntuación final: <span id="puntajeFinal"></span></p>
    <p>Nota: <span id="nota"></span></p>
    <div class="botones">
        <button class="boton2" onclick="location.reload()">Reiniciar</button>
        <button class="boton2" onclick="salir()">Escoger otro</button>
    </div>
</div>

<style>
    @import url("../CSS/prueba1,2.css")
</style>

<script>
    let tiempo = 240;
    let interval;
    let correctos = 0;
    let incorrectos = 0;
    let letraActual = "";
    
    const letrasDisponibles = [
        "Aa", "Bb", "Cc", "Dd", "Ee", "Ff", "Gg", "Hh", "Ii",
        "Jj", "Kk", "Ll", "Mm", "Nn", "Oo", "Pp", "Qq", "Rr",
        "Ss", "Tt", "Uu", "Vv", "Ww", "Xx", "Yy", "Zz"
    ];

    let vocesDisponibles = [];

    // Cargar voces al iniciar
    window.speechSynthesis.onvoiceschanged = () => {
        vocesDisponibles = speechSynthesis.getVoices();
    };

    function iniciarTemporizador() {
        interval = setInterval(function () {
            if (tiempo > 0) {
                tiempo--;
                let minutos = Math.floor(tiempo / 60);
                let segundos = tiempo % 60;
                document.getElementById('tiempo').innerText = 
                    `${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
            } else {
                clearInterval(interval);
                finalizarJuego();
            }
        }, 1000);
    }

    function iniciarJuego() {
        document.getElementById("btnEmpezar").style.display = "none";
        correctos = 0;
        incorrectos = 0;
        document.getElementById("correctos").innerText = correctos;
        document.getElementById("incorrectos").innerText = incorrectos;
        tiempo = 240;
        document.getElementById("tiempo").innerText = "4:00";
        clearInterval(interval);
        iniciarTemporizador();
        pronunciarLetra();
    }

    function pronunciarLetra() {
        letraActual = letrasDisponibles[Math.floor(Math.random() * letrasDisponibles.length)];
        document.getElementById("lugar").textContent = "?";

        const utterance = new SpeechSynthesisUtterance(letraActual.charAt(0)); // Solo pronuncia la letra mayúscula
        utterance.lang = "en-US";
        utterance.rate = 0.8;
        utterance.pitch = 1;

        // Elegir una voz masculina o de inglés si está disponible
        const voz = vocesDisponibles.find(v => v.lang.includes("en") && v.name.toLowerCase().includes("male")) ||
                    vocesDisponibles.find(v => v.lang.includes("en")) ||
                    vocesDisponibles[0];
        if (voz) utterance.voice = voz;

        speechSynthesis.speak(utterance);
    }

    document.querySelectorAll(".letra").forEach(button => {
        button.dataset.originalTop = button.style.top;
        button.dataset.originalLeft = button.style.left;

        button.addEventListener("dragstart", (e) => {
            e.dataTransfer.setData("text", e.target.textContent.trim());
        });
    });

    document.getElementById("lugar").addEventListener("dragover", (e) => {
        e.preventDefault();
    });

    document.getElementById("lugar").addEventListener("drop", (e) => {
        e.preventDefault();
        const letraArrastrada = e.dataTransfer.getData("text").trim();
        e.target.textContent = letraArrastrada;
    });

   
  function verificarRespuesta() {
    const lugar = document.getElementById("lugar");
    const respuesta = lugar.textContent.trim();

    if (respuesta === letraActual) {
        correctos++;
        document.getElementById("correctos").innerText = correctos;

        lugar.style.backgroundColor = "white"; // verde claro
        lugar.textContent = "¡Correcto!";
      
    } else {
        incorrectos++;
        document.getElementById("incorrectos").innerText = incorrectos;

        lugar.style.backgroundColor = "white"; // rojo claro
        lugar.textContent = "Incorrecto";
    
    }

    setTimeout(() => {
        lugar.style.backgroundColor = "";
        pronunciarLetra();
    }, 1000);
}


    function finalizarJuego() {
        clearInterval(interval);
        const resultadoFinal = correctos - incorrectos;
        let nota;

        if (resultadoFinal >= 20) {
            nota = "A";
        } else if (resultadoFinal >= 10) {
            nota = "B";
        } else if (resultadoFinal >= 5) {
            nota = "C";
        } else {
            nota = "F";
        }

        document.getElementById('puntajeFinal').innerText = ` ${resultadoFinal}`;
        document.getElementById('nota').innerText = nota;
        document.getElementById('resultado').style.display = 'block';
    }

    function salir() {
        window.location.href = "Inglegames2.html";
    }
</script>
</body>
</html>
