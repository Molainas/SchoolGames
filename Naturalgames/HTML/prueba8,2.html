<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Naturalgames</title>
</head>
<body>

<div class="cubo">

  <div class="cubo1">

    <div class="cubito1">

      <div class="arriba">

          <div class="bolsa">
           
            <div id="cantidadBolsaOrigen" class="span">--</div>
            <div id="unidadBolsaOrigen" class="span">?</div>
          </div>

          <div class="contenedor">
         
            <div id="cantidadContenedorOrigen" class="span">--</div>
            <div id="unidadContenedorOrigen" class="span">?</div>
          </div>
        

        <p>→</p>

      
          <div class="bolsa">
            <input type="number" id="respuestaBolsa" >
            <div id="unidadBolsaDestino" class="span">?</div>
          </div>

          <div class="contenedor">
            <input type="number" id="respuestaContenedor">
            <div id="unidadContenedorDestino" class="span">?</div>
          </div>
    
      </div>

      <div class="abajo">
        <img src="../imagenes/balanza2.png" class="img2" width="200">
      </div>

    </div>

    <div class="cubito2">

      <button class="verificacion" onclick="verificarRespuesta()">VERIFICAR</button>

      <div class="pequeñin">
        <img class="peque" src="../imagenes/pequenin87652.png" width="120">
      </div>

    </div>

  </div>

  <div class="cubo2">

    <div class="correcto">C: <span id="correctos">0</span></div>
    <div class="tiempo" id="tiempo">05:00</div>
    <div class="incorrecto">F: <span id="incorrectos">0</span></div>

  </div>

</div>

<div id="resultado" class="res" style="display:none;">
  <h2>Juego terminado</h2>
  <p>Puntuación final: <span id="puntajeFinal"></span></p>
  <p>Nota: <span id="nota"></span></p>
  <div class="botones">
    <button class="boton2" onclick="location.reload()">Reiniciar</button>
    <button class="boton2" onclick="salir()">Escoger otro</button>
  </div>
</div>

<style>
    @import url("../CSS/prueba8,2.css");
</style>

<script>
  let correctos = 0;
  let incorrectos = 0;
  let tiempo = 300; // 5 minutos
  let intervalo;
  let respuestaCorrectaBolsa = 0;
  let respuestaCorrectaContenedor = 0;

  const sonidoCorrecto = new Audio('../sonidos/correct-156911.mp3');
  const sonidoIncorrecto = new Audio('../sonidos/error-3-125761.mp3');

  function iniciarTemporizador() {
    intervalo = setInterval(() => {
      if (tiempo > 0) {
        tiempo--;
        const minutos = Math.floor(tiempo / 60);
        const segundos = tiempo % 60;
        document.getElementById('tiempo').innerText = 
          `${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
      } else {
        finalizarJuego();
      }
    }, 1000);
  }

  function finalizarJuego() {
    clearInterval(intervalo);
    const resultadoFinal = correctos - incorrectos;
    let nota = "F";
    if (resultadoFinal >= 20) nota = "A";
    else if (resultadoFinal >= 10) nota = "B";
    else if (resultadoFinal >= 5) nota = "C";

    document.getElementById('puntajeFinal').innerText = resultadoFinal;
    document.getElementById('nota').innerText = nota;
    document.getElementById('resultado').style.display = 'block';
  }

  function generarConversion() {
    // Conversión bolsa (masa)
    const masaConversiones = [
      { unidadOrigen: "g", unidadDestino: "kg", factor: 0.001 },
      { unidadOrigen: "kg", unidadDestino: "g", factor: 1000 }
    ];

    const convBolsa = masaConversiones[Math.floor(Math.random() * masaConversiones.length)];
    const cantidadBolsa = Math.floor(Math.random() * 900 + 100);

    document.getElementById("cantidadBolsaOrigen").innerText = cantidadBolsa;
    document.getElementById("unidadBolsaOrigen").innerText = convBolsa.unidadOrigen;
    document.getElementById("unidadBolsaDestino").innerText = convBolsa.unidadDestino;

    respuestaCorrectaBolsa = cantidadBolsa * convBolsa.factor;

    // Conversión contenedor (volumen)
    const volumenConversiones = [
      { unidadOrigen: "L", unidadDestino: "mL", factor: 1000 },
      { unidadOrigen: "mL", unidadDestino: "L", factor: 0.001 }
    ];

    const convContenedor = volumenConversiones[Math.floor(Math.random() * volumenConversiones.length)];
    const cantidadContenedor = Math.floor(Math.random() * 900 + 100);

    document.getElementById("cantidadContenedorOrigen").innerText = cantidadContenedor;
    document.getElementById("unidadContenedorOrigen").innerText = convContenedor.unidadOrigen;
    document.getElementById("unidadContenedorDestino").innerText = convContenedor.unidadDestino;

    respuestaCorrectaContenedor = cantidadContenedor * convContenedor.factor;

    document.getElementById("respuestaBolsa").value = "";
    document.getElementById("respuestaContenedor").value = "";
  }

  function verificarRespuesta() {
    const respuestaBolsa = parseFloat(document.getElementById("respuestaBolsa").value);
    const respuestaContenedor = parseFloat(document.getElementById("respuestaContenedor").value);

    if (isNaN(respuestaBolsa) || isNaN(respuestaContenedor)) return;

    const aciertoBolsa = Math.abs(respuestaBolsa - respuestaCorrectaBolsa) < 0.01;
    const aciertoContenedor = Math.abs(respuestaContenedor - respuestaCorrectaContenedor) < 0.01;

    if (aciertoBolsa && aciertoContenedor) {
      correctos++;
      sonidoCorrecto.play();
    } else {
      incorrectos++;
      sonidoIncorrecto.play();
    }

    document.getElementById("correctos").innerText = correctos;
    document.getElementById("incorrectos").innerText = incorrectos;

    generarConversion(); // Nuevo desafío
  }

  function iniciarJuego() {
    iniciarTemporizador();
    generarConversion();
  }

  window.onload = iniciarJuego;
</script>

</body>
</html>
